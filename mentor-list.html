<html>
	<head>
		<!-- <HEAD> TEMPLATE -->
		<!-- Meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<!-- CSS tags. nb: files relative to ./nav-redesign, not ./ -->
    <link href="./vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./vendor/font-awesome/css/font-awesome.min.css">
		<style>
			a:hover {
				text-decoration: none;
			}
		</style>

		<!-- END TEMPLATE -->

		<title>Mentor Net - Active Mentors</title>
	</head>
	<body class="text-center">

		<!-- Page Title -->
		<header class="container mt-3 mb-3">
			<h4 class="row">
				<span class="col-6">Mentor Net</span>
				<small class="text-muted col mt-1">Active Mentors</small>
			</h4>
		</header>

		<!-- Vue Entry -->
		<div id="vue-entry">

			<!-- Site Nav -->
			<nav class="mb-1 container py-1">
				<div class="row">
					<div class="col">
					<a href="#" class="btn btn-sm btn-outline-info">
						<i class="fa fa-users"></i><br>Mentors
					</a>
					</div>
					<div class="col">
					<a href="my-profile.html" class="btn btn-sm btn-outline-info">
						<i class="fa fa-user"></i><br>Profile
					</a>
					</div>
					<div class="col">
						<a href="sessions.html" class="btn btn-sm btn-outline-info">
							<i class="fa fa-globe"></i><br>Sessions
						</a>
					</div>
				</div>
			</nav>

			<!-- Active mentor list -->
			<div style="display: none" v-show="1">

				<div v-show="!mentorsRetrieved && !databaseRetrievalError" class="my-5 container">
					<i class="fa fa-2x fa-spinner fa-pulse"></i>
					<br/>
					<br/>
					<p>Loading...</p>
				</div>

				<div v-show="databaseRetrievalError" class="my-5 container">
					<p class="text-danger">
						<i class="fa fa-2x fa-exclamation-triangle"></i>
						<br/>
						<br/>
						The Mentor Net database is offline, please come back later.
					</p>
				</div>

				<div v-show="mentorsRetrieved && mentors.length === 0 && !databaseRetrievalError" class="my-5 container">
					<p class="text-danger">
						<i class="fa fa-2x fa-exclamation-triangle"></i>
						<br/>
						<br/>
						No mentors available at this time, please come back later.
					</p>
				</div>

				<!-- Post-AJAX: Success -->
				<mentor-link
					v-for="mentor in mentors" :key="mentor.uid" 
					:name="mentor.name" :uid="mentor.uid"
					inline-template>

					<a :href=" 'mentor-profile.html?uid=' + uid ">
						<div class="row py-2 pt-3 my-2 bg-dark text-light">
								<div class="col">
									<h5> {{ name }} </h5>
								</div>
								<div class="col">
										<h5><i class="fa fa-chevron-right text-primary"></i></h5>
								</div>
						</div>
					</a>
				</mentor-link>
			</div>
		</div>

		<!-- Footer -->
		<footer class="mt-3">
			<p class="mt-0 text-muted">Got a question? Get in touch:</p>
			<h4 class="row mx-auto w-50">
				<a href="mailto:tom@joinmentornet.me" class="col">
					<i class="fa fa-envelope"></i>
					<p class="h6 mt-2">Email</p>
				</a>

				<a href="tel:0450797678" class="col">
					<i class="fa fa-phone"></i>
					<p class="h6 mt-2">Phone</p>
				</a>
			</h4>
		</footer>

		<!-- Javascript (global) -->
		<script src="https://cdn.jsdelivr.net/npm/vue"></script>
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

		<script src="./js/generics.js"></script>
		<script src="./js/session-data.js"></script>
		<!-- Javascript (local) -->
		<script>
			if (!hasSessionData()) reauthAndReturn();

			Vue.component('mentor-link', { props: [ 'name', 'uid' ] });

			let vue = new Vue({
				el: '#vue-entry',
				data: {
					mentors: [],
					mentorsRetrieved: false,
					credit: data.credit,
					databaseRetrievalError: false
				},
				computed: {
					userHasBooking () {
						return data.booking ? true : false;
					},
					bookedMentorURL () {
						if (!this.userHasBooking) return '#';
						return 'mentor-profile.html?uid=' + data.booking.mentorUID;
					}
				}
			});

			http.get('/mentors')
				.then(response => {
					vue.mentors = response.data;
					vue.mentorsRetrieved = true;
				}).catch(err => {
					vue.databaseRetrievalError = true;
					handleAxiosError(err);
				});

		</script>
	</body>
</html>
